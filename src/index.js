const HTML_B64='PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KCjxoZWFkPgogICAgPCEtLSBHb29nbGUgdGFnIChndGFnLmpzKSAtLT4KICAgIDxzY3JpcHQgYXN5bmMgc3JjPSJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbS9ndGFnL2pzP2lkPUctRFo5TTA0Q01FRCI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0PgogICAgICB3aW5kb3cuZGF0YUxheWVyID0gd2luZG93LmRhdGFMYXllciB8fCBbXTsKICAgICAgZnVuY3Rpb24gZ3RhZygpe2RhdGFMYXllci5wdXNoKGFyZ3VtZW50cyk7fQogICAgICBndGFnKCdqcycsIG5ldyBEYXRlKCkpOwoKICAgICAgZ3RhZygnY29uZmlnJywgJ0ctRFo5TTA0Q01FRCcpOwogICAgPC9zY3JpcHQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+REtJTSBSZXBsYXkgQXR0YWNrIExhYjwvdGl0bGU+CiAgICA8bGluayBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2Jvb3RzdHJhcEA1LjMuMC9kaXN0L2Nzcy9ib290c3RyYXAubWluLmNzcyIgcmVsPSJzdHlsZXNoZWV0Ij4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuMC4wL2Nzcy9hbGwubWluLmNzcyI+CiAgICA8bGluayByZWw9InByZWNvbm5lY3QiIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20iPgogICAgPGxpbmsgcmVsPSJwcmVjb25uZWN0IiBocmVmPSJodHRwczovL2ZvbnRzLmdzdGF0aWMuY29tIiBjcm9zc29yaWdpbj4KICAgIDxsaW5rCiAgICAgICAgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1JbnRlcjp3Z2h0QDMwMDs0MDA7NTAwOzYwMDs3MDA7ODAwJmZhbWlseT1KZXRCcmFpbnMrTW9ubzp3Z2h0QDQwMDs1MDAmZGlzcGxheT1zd2FwIgogICAgICAgIHJlbD0ic3R5bGVzaGVldCI+CiAgICA8c3R5bGU+CiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMxZTFlMmU7CiAgICAgICAgICAgIGNvbG9yOiAjY2RkNmY0OwogICAgICAgICAgICBmb250LWZhbWlseTogJ0ludGVyJywgLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCBzYW5zLXNlcmlmOwogICAgICAgIH0KCiAgICAgICAgLmNhcmQgewogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzEzMjQ0OwogICAgICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDZweCByZ2JhKDAsIDAsIDAsIDAuMyk7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICAgICAgfQoKICAgICAgICAuY2FyZC1oZWFkZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNDU0NzVhOwogICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgIzU4NWI3MDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgfQoKICAgICAgICAuY2FyZC1oZWFkZXIudGV4dC1jZW50ZXIudGV4dC13aGl0ZSB7CiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA5MDA7CiAgICAgICAgICAgIHRleHQtc2hhZG93OiAwIDJweCA2cHggcmdiYSgwLCAwLCAwLCAwLjg1KTsKICAgICAgICAgICAgbGV0dGVyLXNwYWNpbmc6IDAuMDJlbTsKICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjEpOwogICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDE2cHg7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4wNXJlbTsKICAgICAgICAgICAgb3BhY2l0eTogMSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLyogVGVybWluYWwgU3R5bGluZyAqLwogICAgICAgIC50ZXJtaW5hbC13aW5kb3cgewogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTExMTFiOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAnSmV0QnJhaW5zIE1vbm8nLCAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44MnJlbTsKICAgICAgICAgICAgY29sb3I6ICNhNmUzYTE7CiAgICAgICAgICAgIGhlaWdodDogMzAwcHg7CiAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87CiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICM1ODViNzA7CiAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsKICAgICAgICB9CgogICAgICAgIC5oaWdobGlnaHQtc2lnIHsKICAgICAgICAgICAgY29sb3I6ICNmOWUyYWY7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggZGFzaGVkICNmOWUyYWY7CiAgICAgICAgfQoKICAgICAgICAuaGlnaGxpZ2h0LWhlYWRlciB7CiAgICAgICAgICAgIGNvbG9yOiAjODliNGZhOwogICAgICAgIH0KCiAgICAgICAgLyogQW5pbWF0aW9uIFpvbmUgKi8KICAgICAgICAubmV0d29yay1wYXRoIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgICAgICBwYWRkaW5nOiA0MHB4IDIwcHg7CiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzE4MTgyNTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgICAgICBtYXJnaW46IDIwcHggMDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICB9CgogICAgICAgIC5ub2RlLWljb24gewogICAgICAgICAgICBmb250LXNpemU6IDNyZW07CiAgICAgICAgICAgIGNvbG9yOiAjY2JhNmY3OwogICAgICAgICAgICB6LWluZGV4OiAyOwogICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgfQoKICAgICAgICAubm9kZS1sYWJlbCB7CiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOwogICAgICAgICAgICBmb250LXNpemU6IDAuOHJlbTsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBtYXJnaW4tdG9wOiA1cHg7CiAgICAgICAgICAgIGNvbG9yOiAjYmFjMmRlOwogICAgICAgIH0KCiAgICAgICAgLnBhY2tldCB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgbGVmdDogMTAlOwogICAgICAgICAgICB0b3A6IDUwJTsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOwogICAgICAgICAgICBmb250LXNpemU6IDEuNXJlbTsKICAgICAgICAgICAgY29sb3I6ICNmMzhiYTg7CiAgICAgICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgICAgIHotaW5kZXg6IDE7CiAgICAgICAgfQoKICAgICAgICBAa2V5ZnJhbWVzIGF0dGFja01vdmUgewogICAgICAgICAgICAwJSB7IGxlZnQ6IDEwJTsgb3BhY2l0eTogMTsgfQogICAgICAgICAgICA1MCUgeyBsZWZ0OiA1MCU7IG9wYWNpdHk6IDE7IH0KICAgICAgICAgICAgMTAwJSB7IGxlZnQ6IDkwJTsgb3BhY2l0eTogMDsgfQogICAgICAgIH0KCiAgICAgICAgLmFuaW1hdGUtYXR0YWNrIHsKICAgICAgICAgICAgYW5pbWF0aW9uOiBhdHRhY2tNb3ZlIDJzIGVhc2UtaW4tb3V0IGZvcndhcmRzOwogICAgICAgIH0KCiAgICAgICAgLnN0YXR1cy1iYWRnZSB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4ycmVtOwogICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDIwcHg7CiAgICAgICAgfQoKICAgICAgICAvKiBWdWxuZXJhYmlsaXR5IFNjYW5uZXIgU3R5bGVzICovCiAgICAgICAgLnZ1bG4tY2FyZCB7CiAgICAgICAgICAgIGJvcmRlci1sZWZ0OiA0cHggc29saWQgIzU4NWI3MDsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzFiMWIyNjsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDE2cHg7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGJvcmRlci1jb2xvciAwLjNzLCB0cmFuc2Zvcm0gMC4yczsKICAgICAgICAgICAgY29sb3I6ICNlNmVlZjg7CiAgICAgICAgfQoKICAgICAgICAudnVsbi1jYXJkIHN0cm9uZyB7CiAgICAgICAgICAgIGNvbG9yOiAjZGJlYWZlOwogICAgICAgICAgICBmb250LXdlaWdodDogNzAwOwogICAgICAgICAgICBmb250LXNpemU6IDEuMDVyZW07CiAgICAgICAgfQoKICAgICAgICAudnVsbi1jYXJkIHNtYWxsLAogICAgICAgIC52dWxuLWNhcmQgLnRleHQtbXV0ZWQgewogICAgICAgICAgICBjb2xvcjogI2JhYzJkZSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLnZ1bG4tY2FyZCAuYmFkZ2UgewogICAgICAgICAgICBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgLnZ1bG4tY2FyZDpob3ZlciB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCg0cHgpOwogICAgICAgIH0KCiAgICAgICAgLnZ1bG4tY2FyZC5zZXZlcml0eS1oaWdoIHsgYm9yZGVyLWxlZnQtY29sb3I6ICNmMzhiYTg7IH0KICAgICAgICAudnVsbi1jYXJkLnNldmVyaXR5LW1lZGl1bSB7IGJvcmRlci1sZWZ0LWNvbG9yOiAjZmFiMzg3OyB9CiAgICAgICAgLnZ1bG4tY2FyZC5zZXZlcml0eS1vayB7IGJvcmRlci1sZWZ0LWNvbG9yOiAjYTZlM2ExOyB9CgogICAgICAgIC5yaXNrLWdhdWdlIHsKICAgICAgICAgICAgd2lkdGg6IDEyMHB4OwogICAgICAgICAgICBoZWlnaHQ6IDEyMHB4OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGNvbmljLWdyYWRpZW50KHZhcigtLWdhdWdlLWNvbG9yLCAjNTg1YjcwKSB2YXIoLS1nYXVnZS1wY3QsIDAlKSwgIzMxMzI0NCAwJSk7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBtYXJnaW46IDAgYXV0byAxMHB4OwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgMjBweCByZ2JhKDAsIDAsIDAsIDAuNCk7CiAgICAgICAgfQoKICAgICAgICAucmlzay1nYXVnZS1pbm5lciB7CiAgICAgICAgICAgIHdpZHRoOiA5MHB4OwogICAgICAgICAgICBoZWlnaHQ6IDkwcHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzFlMWUyZTsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgfQoKICAgICAgICAucmlzay1nYXVnZS1pbm5lciAuc2NvcmUgewogICAgICAgICAgICBmb250LXNpemU6IDEuOHJlbTsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDgwMDsKICAgICAgICB9CgogICAgICAgIC5yaXNrLWdhdWdlLWlubmVyIC5sYWJlbCB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC42NXJlbTsKICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICAgICAgICAgICAgY29sb3I6ICNiYWMyZGU7CiAgICAgICAgfQoKICAgICAgICAuc2Nhbi1zcGlubmVyIHsKICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgICAgICAgICB3aWR0aDogMThweDsKICAgICAgICAgICAgaGVpZ2h0OiAxOHB4OwogICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMyk7CiAgICAgICAgICAgIGJvcmRlci10b3AtY29sb3I6ICNmZmY7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgYW5pbWF0aW9uOiBzcGluIDAuNnMgbGluZWFyIGluZmluaXRlOwogICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDZweDsKICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsKICAgICAgICB9CgogICAgICAgIEBrZXlmcmFtZXMgc3BpbiB7CiAgICAgICAgICAgIHRvIHsgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTsgfQogICAgICAgIH0KCiAgICAgICAgLyogRWR1Y2F0aW9uYWwgYWNjb3JkaW9uICovCiAgICAgICAgLmFjY29yZGlvbi1pdGVtIHsKICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzMxMzI0NDsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgIzQ1NDc1YTsKICAgICAgICB9CgogICAgICAgIC5hY2NvcmRpb24tYnV0dG9uIHsKICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzQ1NDc1YTsKICAgICAgICAgICAgY29sb3I6ICNjZGQ2ZjQ7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgfQoKICAgICAgICAuYWNjb3JkaW9uLWJ1dHRvbjpub3QoLmNvbGxhcHNlZCkgewogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNTg1YjcwOwogICAgICAgICAgICBjb2xvcjogI2NkZDZmNDsKICAgICAgICAgICAgYm94LXNoYWRvdzogbm9uZTsKICAgICAgICB9CgogICAgICAgIC5hY2NvcmRpb24tYnV0dG9uOmZvY3VzIHsKICAgICAgICAgICAgYm94LXNoYWRvdzogbm9uZTsKICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjNTg1YjcwOwogICAgICAgIH0KCiAgICAgICAgLmFjY29yZGlvbi1idXR0b246OmFmdGVyIHsKICAgICAgICAgICAgZmlsdGVyOiBpbnZlcnQoMC44KTsKICAgICAgICB9CgogICAgICAgIC5hY2NvcmRpb24tYm9keSB7CiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMzMTMyNDQ7CiAgICAgICAgICAgIGNvbG9yOiAjY2RkNmY0OwogICAgICAgIH0KCiAgICAgICAgLmNvbmNlcHQtY2FyZCB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMxODE4MjU7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICAgICAgcGFkZGluZzogMTZweDsKICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgIH0KCiAgICAgICAgLmNvbmNlcHQtY2FyZCBoNiB7CiAgICAgICAgICAgIGNvbG9yOiAjODliNGZhOwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICAgICAgfQoKICAgICAgICAuY29uY2VwdC1jYXJkIHAgewogICAgICAgICAgICBmb250LXNpemU6IDAuOXJlbTsKICAgICAgICAgICAgY29sb3I6ICNiYWMyZGU7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDA7CiAgICAgICAgfQoKICAgICAgICAuc3RlcC1udW1iZXIgewogICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtZmxleDsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgICAgIHdpZHRoOiAyOHB4OwogICAgICAgICAgICBoZWlnaHQ6IDI4cHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzg5YjRmYTsKICAgICAgICAgICAgY29sb3I6ICMxZTFlMmU7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NXJlbTsKICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiA4cHg7CiAgICAgICAgfQoKICAgICAgICAuaW5mby10ZXh0IHsKICAgICAgICAgICAgZm9udC1zaXplOiAwLjg1cmVtOwogICAgICAgICAgICBjb2xvcjogIzkzOTliMjsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTJweDsKICAgICAgICB9CiAgICA8L3N0eWxlPgo8L2hlYWQ+Cgo8Ym9keT4KCiAgICA8ZGl2IGNsYXNzPSJjb250YWluZXIgcHktNCI+CiAgICAgICAgPGgyIGNsYXNzPSJ0ZXh0LWNlbnRlciBtYi0xIj48aSBjbGFzcz0iZmFzIGZhLXNoaWVsZC12aXJ1cyI+PC9pPiBES0lNIFJlcGxheSBBdHRhY2sgTGFiPC9oMj4KICAgICAgICA8cCBjbGFzcz0idGV4dC1jZW50ZXIgbWItNCIgc3R5bGU9ImNvbG9yOiAjOTM5OWIyOyI+QW4gaW50ZXJhY3RpdmUgbGFiIHRvIHVuZGVyc3RhbmQgZW1haWwgYXV0aGVudGljYXRpb24sIHJlcGxheSBhdHRhY2tzLCBhbmQgZGVmZW5zZXMuPC9wPgoKICAgICAgICA8IS0tIEVkdWNhdGlvbmFsIEludHJvIC0tPgogICAgICAgIDxkaXYgY2xhc3M9ImFjY29yZGlvbiBtYi00IiBpZD0ibGVhcm5BY2NvcmRpb24iPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJhY2NvcmRpb24taXRlbSI+CiAgICAgICAgICAgICAgICA8aDIgY2xhc3M9ImFjY29yZGlvbi1oZWFkZXIiPgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImFjY29yZGlvbi1idXR0b24iIHR5cGU9ImJ1dHRvbiIgZGF0YS1icy10b2dnbGU9ImNvbGxhcHNlIgogICAgICAgICAgICAgICAgICAgICAgICBkYXRhLWJzLXRhcmdldD0iI2xlYXJuU2VjdGlvbiIgYXJpYS1leHBhbmRlZD0idHJ1ZSIgYXJpYS1jb250cm9scz0ibGVhcm5TZWN0aW9uIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1ncmFkdWF0aW9uLWNhcCBtZS0yIj48L2k+IEJhY2tncm91bmQ6IFdoYXQgWW91IE5lZWQgdG8gS25vdwogICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9oMj4KICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImxlYXJuU2VjdGlvbiIgY2xhc3M9ImFjY29yZGlvbi1jb2xsYXBzZSBjb2xsYXBzZSBzaG93IiBkYXRhLWJzLXBhcmVudD0iI2xlYXJuQWNjb3JkaW9uIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhY2NvcmRpb24tYm9keSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyBnLTMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmNlcHQtY2FyZCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNj48aSBjbGFzcz0iZmFzIGZhLWtleSBtZS0xIj48L2k+IERLSU08L2g2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5Eb21haW5LZXlzIElkZW50aWZpZWQgTWFpbCBhZGRzIGEgY3J5cHRvZ3JhcGhpYyBzaWduYXR1cmUgdG8gb3V0Z29pbmcgZW1haWxzLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhlIHNlbmRpbmcgc2VydmVyIHNpZ25zIHdpdGggYSA8c3Ryb25nPnByaXZhdGUga2V5PC9zdHJvbmc+OyB0aGUgcmVjZWl2aW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2ZXIgdmVyaWZpZXMgdXNpbmcgdGhlIDxzdHJvbmc+cHVibGljIGtleTwvc3Ryb25nPiBwdWJsaXNoZWQgaW4gRE5TLjwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmNlcHQtY2FyZCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNj48aSBjbGFzcz0iZmFzIGZhLXJvdGF0ZSBtZS0xIj48L2k+IFJlcGxheSBBdHRhY2s8L2g2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5BbiBhdHRhY2tlciBpbnRlcmNlcHRzIGEgbGVnaXRpbWF0ZWx5IHNpZ25lZCBlbWFpbCBhbmQgPHN0cm9uZz5yZXNlbmRzIGl0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0ZXI8L3N0cm9uZz4uIFNpbmNlIHN0YW5kYXJkIERLSU0gaGFzIG5vIGV4cGlyeSwgdGhlIHNpZ25hdHVyZSBzdGF5cwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWQgZm9yZXZlciAmbWRhc2g7IHRoZSByZXBsYXllZCBlbWFpbCBwYXNzZXMgdmVyaWZpY2F0aW9uLjwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmNlcHQtY2FyZCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNj48aSBjbGFzcz0iZmFzIGZhLWNsb2NrIG1lLTEiPjwvaT4gVGhlIERlZmVuc2U8L2g2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5TdHJpY3QgdGltZXN0YW1wIGV4cGlyeSBjaGVja3MgdGhlIDxjb2RlPnQ9PC9jb2RlPiB0YWcgaW4gdGhlIERLSU0gc2lnbmF0dXJlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSWYgdGhlIHNpZ25hdHVyZSBpcyBvbGRlciB0aGFuIHRoZSBhbGxvd2VkIHdpbmRvdyAoNXMgaW4gdGhpcyBsYWIpLCB0aGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlciA8c3Ryb25nPnJlamVjdHMgaXQ8L3N0cm9uZz4uPC9wPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtMyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uY2VwdC1jYXJkIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg2PjxpIGNsYXNzPSJmYXMgZmEtbGlzdC1vbCBtZS0xIj48L2k+IExhYiBTdGVwczwvaDY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPjxzdHJvbmc+U3RlcCAxOjwvc3Ryb25nPiBHZW5lcmF0ZSBhIHNpZ25lZCBlbWFpbC48YnI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Ryb25nPlN0ZXAgMjo8L3N0cm9uZz4gV2FpdCBhIGZldyBzZWNvbmRzIChzaW11bGF0aW5nIGludGVyY2VwdGlvbikuPGJyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz5TdGVwIDM6PC9zdHJvbmc+IFJlcGxheSBpdCBhbmQgb2JzZXJ2ZSB0aGUgcmVzdWx0Ljxicj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRyeSBib3RoIFZ1bG5lcmFibGUgYW5kIFNlY3VyZSBtb2RlcyEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9wPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8IS0tIFN0ZXAgMTogQ29uZmlndXJhdGlvbiArIFJhdyBFbWFpbCAtLT4KICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNSI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkLWhlYWRlciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzdGVwLW51bWJlciI+MTwvc3Bhbj4gQ29uZmlndXJhdGlvbgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQtYm9keSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJpbmZvLXRleHQiPkNvbmZpZ3VyZSB0aGUgc2ltdWxhdGlvbiwgdGhlbiBnZW5lcmF0ZSBhIERLSU0tc2lnbmVkIGVtYWlsLiBJbiBhIHJlYWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGFjaywgdGhpcyBlbWFpbCB3b3VsZCBiZSBpbnRlcmNlcHRlZCBpbiB0cmFuc2l0LjwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgPGZvcm0gaWQ9ImNvbmZpZ0Zvcm0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWItMyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJmb3JtLWxhYmVsIj5UYXJnZXQgRG9tYWluPC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImZvcm0tY29udHJvbCBiZy1kYXJrIHRleHQtbGlnaHQgYm9yZGVyLXNlY29uZGFyeSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9InRhcmdldERvbWFpbiIgdmFsdWU9ImV4YW1wbGUuY29tIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgY2xhc3M9InRleHQtbXV0ZWQiPlVzZWQgZm9yIHNpbXVsYXRpb24uIEFsc28gdXNlZCBmb3IgcmVhbCBETlMgY2hlY2tzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlbG93Ljwvc21hbGw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtYi0zIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZvcm0tbGFiZWwgZnctYm9sZCI+RGVmZW5zZSBTdHJhdGVneTwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBjbGFzcz0iZm9ybS1zZWxlY3QgYmctZGFyayB0ZXh0LWxpZ2h0IGJvcmRlci1zZWNvbmRhcnkiIGlkPSJkZWZlbnNlTW9kZSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImZhbHNlIj5WdWxuZXJhYmxlIChTdGFuZGFyZCBES0lNICZtZGFzaDsgbm8gZXhwaXJ5KTwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJ0cnVlIj5TZWN1cmUgKFN0cmljdCA1cyBFeHBpcnkpPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSB3LTEwMCIgb25jbGljaz0iZ2VuZXJhdGVFbWFpbCgpIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWZpbGUtc2lnbmF0dXJlIj48L2k+IEludGVyY2VwdCAmYW1wOyBTaWduIEVtYWlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9mb3JtPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC03Ij4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQtaGVhZGVyIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtYmV0d2VlbiI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPjxpIGNsYXNzPSJmYXMgZmEtdGVybWluYWwiPjwvaT4gSW50ZXJjZXB0ZWQgRW1haWwgKFJhdyBTb3VyY2UpPC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iYmFkZ2UgYmctd2FybmluZyB0ZXh0LWRhcmsiIGlkPSJ0aW1lckJhZGdlIiBzdHlsZT0iZGlzcGxheTpub25lIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNpZ25hdHVyZSBleHBpcmVzIGluOiA8c3BhbiBpZD0idGltZUxlZnQiPjA8L3NwYW4+cwogICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZC1ib2R5IHAtMCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9InJhd0VtYWlsRGlzcGxheSIgY2xhc3M9InRlcm1pbmFsLXdpbmRvdyI+QXdhaXRpbmcgaW50ZXJjZXB0aW9uLi4uCkNsaWNrICJJbnRlcmNlcHQgJmFtcDsgU2lnbiBFbWFpbCIgdG8gZ2VuZXJhdGUgYSBES0lNLXNpZ25lZCBtZXNzYWdlLjwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgoKICAgICAgICA8IS0tIFN0ZXAgMjogQXR0YWNrIFNpbXVsYXRpb24gLS0+CiAgICAgICAgPGRpdiBjbGFzcz0icm93IG10LTQiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtMTIiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZC1oZWFkZXIgdGV4dC1jZW50ZXIgYmctZGFuZ2VyIHRleHQtd2hpdGUiPgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ic3RlcC1udW1iZXIiIHN0eWxlPSJiYWNrZ3JvdW5kOiNmZmY7Y29sb3I6I2RjMzU0NTsiPjI8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgIEF0dGFjayBTaW11bGF0aW9uIFpvbmUKICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkLWJvZHkgdGV4dC1jZW50ZXIiPgogICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz0iaW5mby10ZXh0IiBzdHlsZT0ibWF4LXdpZHRoOjYwMHB4O21hcmdpbjowIGF1dG8gMTZweDsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhlIGF0dGFja2VyIGhhcyB0aGUgc2lnbmVkIGVtYWlsIGZyb20gU3RlcCAxLiBUaGV5IG5vdyByZXBsYXkgaXQgdG8gdGhlIHZpY3RpbSdzIG1haWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlci4gV2lsbCB0aGUgc2VydmVyIGFjY2VwdCBvciByZWplY3QgaXQ/CiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD4KCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1kYW5nZXIgYnRuLWxnIHB4LTUgbWItMyIgb25jbGljaz0icmVwbGF5QXR0YWNrKCkiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1wYXBlci1wbGFuZSI+PC9pPiBMYXVuY2ggUmVwbGF5IEF0dGFjawogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5ldHdvcmstcGF0aCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXh0LWNlbnRlciI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibm9kZS1pY29uIj48aSBjbGFzcz0iZmFzIGZhLXVzZXItc2VjcmV0Ij48L2k+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im5vZGUtbGFiZWwiPkF0dGFja2VyPC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0icGFja2V0IiBjbGFzcz0icGFja2V0Ij48aSBjbGFzcz0iZmFzIGZhLWVudmVsb3BlIj48L2k+PC9kaXY+CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGV4dC1jZW50ZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5vZGUtaWNvbiI+PGkgY2xhc3M9ImZhcyBmYS1zZXJ2ZXIiPjwvaT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibm9kZS1sYWJlbCI+VmljdGltIE1haWwgU2VydmVyPC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0icmVzdWx0QXJlYSIgc3R5bGU9Im9wYWNpdHk6IDA7IHRyYW5zaXRpb246IG9wYWNpdHkgMC41czsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg0PlNlcnZlciBWZXJkaWN0OjwvaDQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBpZD0idmVyaWZ5U3RhdHVzIiBjbGFzcz0iYmFkZ2UgYmctc2Vjb25kYXJ5IHN0YXR1cy1iYWRnZSI+V0FJVElORzwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJtdC0yIiBpZD0idmVyaWZ5RGV0YWlscyIgc3R5bGU9ImNvbG9yOiAjODlkY2ViOyI+PC9wPgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gRXhwbGFuYXRpb24gc2hvd24gYWZ0ZXIgcmVzdWx0IC0tPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0iZXhwbGFuYXRpb25BcmVhIiBjbGFzcz0ibXQtMyB0ZXh0LXN0YXJ0IG14LWF1dG8iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9Im1heC13aWR0aDo2MDBweDsgZGlzcGxheTpub25lOyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29uY2VwdC1jYXJkIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg2PjxpIGNsYXNzPSJmYXMgZmEtbGlnaHRidWxiIG1lLTEiPjwvaT4gV2hhdCBIYXBwZW5lZD88L2g2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBpZD0iZXhwbGFuYXRpb25UZXh0Ij48L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8IS0tIEluYm94IFNpbXVsYXRpb24gLS0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3cgbXQtMyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTYiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkIGJnLWRhcmsgdGV4dC1saWdodCBwLTIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZC1oZWFkZXIgc21hbGwiIHN0eWxlPSJjb2xvcjojYTZlM2ExOyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1pbmJveCBtZS0xIj48L2k+IFZpY3RpbSdzIEluYm94CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9InZpY3RpbUluYm94IiBjbGFzcz0icC0zIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJtaW4taGVpZ2h0OjEyMHB4OyBiYWNrZ3JvdW5kOiMwZjExMTY7IGJvcmRlci1yYWRpdXM6NnB4OyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGVtIGNsYXNzPSJzbWFsbCB0ZXh0LW11dGVkIj5ObyBtZXNzYWdlcyB5ZXQuPC9lbT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtbWQtNiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQgYmctZGFyayB0ZXh0LWxpZ2h0IHAtMiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjYXJkLWhlYWRlciBzbWFsbCIgc3R5bGU9ImNvbG9yOiNmMzhiYTg7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWJhbiBtZS0xIj48L2k+IFJlamVjdGVkIC8gUXVhcmFudGluZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJxdWFyYW50aW5lSW5ib3giIGNsYXNzPSJwLTMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9Im1pbi1oZWlnaHQ6MTIwcHg7IGJhY2tncm91bmQ6IzBmMTExNjsgYm9yZGVyLXJhZGl1czo2cHg7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZW0gY2xhc3M9InNtYWxsIHRleHQtbXV0ZWQiPk5vIG1lc3NhZ2VzIHlldC48L2VtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPCEtLSBTdGVwIDM6IERvbWFpbiBWdWxuZXJhYmlsaXR5IFNjYW5uZXIgLS0+CiAgICAgICAgPGRpdiBjbGFzcz0icm93IG10LTQiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtMTIiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZCI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZC1oZWFkZXIgdGV4dC1jZW50ZXIgdGV4dC13aGl0ZSIKICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9ImJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM0NTQ3NWEsICM1ODViNzApOyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzdGVwLW51bWJlciIgc3R5bGU9ImJhY2tncm91bmQ6I2ZhYjM4Nztjb2xvcjojMWUxZTJlOyI+Mzwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgRG9tYWluIFZ1bG5lcmFiaWxpdHkgU2Nhbm5lcgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQtYm9keSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRleHQtY2VudGVyIG1iLTMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9ImluZm8tdGV4dCI+U2NhbiBhIHJlYWwgZG9tYWluJ3MgRE5TIHJlY29yZHMgdG8gY2hlY2sgaXRzIERLSU0sIERNQVJDLCBhbmQgU1BGCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbiBmb3Igd2Vha25lc3Nlcy48L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tb3V0bGluZS13YXJuaW5nIGJ0bi1sZyBweC00IiBpZD0ic2NhbkJ0biIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmNsaWNrPSJzY2FuRG9tYWluKCkiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtY3Jvc3NoYWlycyI+PC9pPiBTY2FuIERvbWFpbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0idnVsblJlc3VsdHMiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJvdyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTQgdGV4dC1jZW50ZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJyaXNrLWdhdWdlIiBpZD0icmlza0dhdWdlIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InJpc2stZ2F1Z2UtaW5uZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzY29yZSIgaWQ9InJpc2tTY29yZSI+Jm1kYXNoOzwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibGFiZWwiPlJpc2sgU2NvcmU8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJiYWRnZSBmcy02IHB4LTMgcHktMiIgaWQ9InZlcmRpY3RCYWRnZSI+Jm1kYXNoOzwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9Im10LTIgc21hbGwiIGlkPSJ2ZXJkaWN0U3VtbWFyeSIgc3R5bGU9ImNvbG9yOiAjYmZjYmU2OyI+PC9wPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC04Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg2IGNsYXNzPSJ0ZXh0LW11dGVkIG1iLTIiPjxpIGNsYXNzPSJmYXMgZmEtbGlzdC1jaGVjayI+PC9pPiBGaW5kaW5nczwvaDY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImZpbmRpbmdzTGlzdCI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICAgICAgICAgICAgICA8IS0tIEVkdWNhdGlvbmFsIHJlZmVyZW5jZSBmb3Igc2Nhbm5lciAtLT4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icm93IG10LTQgZy0zIiBpZD0ic2Nhbm5lckVkdWNhdGlvbiIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29sLW1kLTQiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbmNlcHQtY2FyZCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNj48aSBjbGFzcz0iZmFzIGZhLWtleSBtZS0xIj48L2k+IERLSU08L2g2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5TaWducyBlbWFpbHMgY3J5cHRvZ3JhcGhpY2FsbHkuIFdpdGhvdXQgaXQsIGFueSBzZXJ2ZXIgY2FuIGZvcmdlIGVtYWlscyBmcm9tCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzIGRvbWFpbiB3aXRoIG5vIGRldGVjdGlvbi48L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC00Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25jZXB0LWNhcmQiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDY+PGkgY2xhc3M9ImZhcyBmYS1zaGllbGQtaGFsdmVkIG1lLTEiPjwvaT4gRE1BUkM8L2g2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5UZWxscyByZWNlaXZpbmcgc2VydmVycyB3aGF0IHRvIGRvIHdoZW4gREtJTS9TUEYgZmFpbHM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Y29kZT5ub25lPC9jb2RlPiA9IGlnbm9yZSwgPGNvZGU+cXVhcmFudGluZTwvY29kZT4gPSBzcGFtLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGNvZGU+cmVqZWN0PC9jb2RlPiA9IGJsb2NrLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNvbC1tZC00Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJjb25jZXB0LWNhcmQiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDY+PGkgY2xhc3M9ImZhcyBmYS1lbnZlbG9wZS1vcGVuLXRleHQgbWUtMSI+PC9pPiBTUEY8L2g2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5MaXN0cyB3aGljaCBtYWlsIHNlcnZlcnMgYXJlIGF1dGhvcml6ZWQgdG8gc2VuZCBlbWFpbCBmb3IgdGhlIGRvbWFpbi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxjb2RlPi1hbGw8L2NvZGU+ID0gcmVqZWN0IHVuYXV0aG9yaXplZCwgPGNvZGU+fmFsbDwvY29kZT4gPSBzb2Z0IGZhaWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Y29kZT4rYWxsPC9jb2RlPiA9IGFsbG93IGV2ZXJ5b25lLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgPC9kaXY+CgogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vYm9vdHN0cmFwQDUuMy4wL2Rpc3QvanMvYm9vdHN0cmFwLmJ1bmRsZS5taW4uanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdD4KICAgICAgICBsZXQgY3VycmVudFJhd0VtYWlsID0gIiI7CiAgICAgICAgbGV0IGV4cGlyeVRpbWVySWQgPSBudWxsOyAvLyB0cmFjayB0aW1lciB0byBwcmV2ZW50IGxlYWtzCgogICAgICAgIGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlRW1haWwoKSB7CiAgICAgICAgICAgIGNvbnN0IHVzZURlZmVuc2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVmZW5zZU1vZGUnKS52YWx1ZSA9PT0gJ3RydWUnOwogICAgICAgICAgICBjb25zdCBkb21haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFyZ2V0RG9tYWluJykudmFsdWUudHJpbSgpOwoKICAgICAgICAgICAgLy8gUmVzZXQgVUkKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdEFyZWEnKS5zdHlsZS5vcGFjaXR5ID0gJzAnOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFja2V0JykuY2xhc3NMaXN0LnJlbW92ZSgnYW5pbWF0ZS1hdHRhY2snKTsKICAgICAgICAgICAgY29uc3QgZXhwbGFuYXRpb25BcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4cGxhbmF0aW9uQXJlYScpOwogICAgICAgICAgICBpZiAoZXhwbGFuYXRpb25BcmVhKSBleHBsYW5hdGlvbkFyZWEuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvc2lnbicsIHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSwKICAgICAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IHVzZV9kZWZlbnNlOiB1c2VEZWZlbnNlLCBkb21haW46IGRvbWFpbiB9KQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgdGhyb3cgbmV3IEVycm9yKGBTZXJ2ZXIgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApOwogICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKCiAgICAgICAgICAgICAgICBjdXJyZW50UmF3RW1haWwgPSBkYXRhLnJhd19lbWFpbDsKCiAgICAgICAgICAgICAgICAvLyBTeW50YXggSGlnaGxpZ2h0IGZvciBUZXJtaW5hbAogICAgICAgICAgICAgICAgbGV0IGRpc3BsYXlIdG1sID0gY3VycmVudFJhd0VtYWlsCiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLzwvZywgIiZsdDsiKS5yZXBsYWNlKC8+L2csICImZ3Q7IikKICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvKERLSU0tU2lnbmF0dXJlOikvZywgJzxzcGFuIGNsYXNzPSJoaWdobGlnaHQtaGVhZGVyIj4kMTwvc3Bhbj4nKQogICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8oYj1bXHdcLys9XSspL2csICc8c3BhbiBjbGFzcz0iaGlnaGxpZ2h0LXNpZyI+JDE8L3NwYW4+Jyk7CgogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jhd0VtYWlsRGlzcGxheScpLmlubmVySFRNTCA9IGRpc3BsYXlIdG1sOwoKICAgICAgICAgICAgICAgIC8vIENsZWFyIGFueSBwcmV2aW91cyB0aW1lcgogICAgICAgICAgICAgICAgaWYgKGV4cGlyeVRpbWVySWQpIHsKICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGV4cGlyeVRpbWVySWQpOwogICAgICAgICAgICAgICAgICAgIGV4cGlyeVRpbWVySWQgPSBudWxsOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIFRpbWVyIExvZ2ljIChkZWZlbnNlIG1vZGUgb25seSkKICAgICAgICAgICAgICAgIGlmICh1c2VEZWZlbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHRpbWVMZWZ0ID0gNTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiYWRnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lckJhZGdlJyk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGltZVNwYW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZUxlZnQnKTsKICAgICAgICAgICAgICAgICAgICBiYWRnZS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7CiAgICAgICAgICAgICAgICAgICAgdGltZVNwYW4uaW5uZXJUZXh0ID0gdGltZUxlZnQ7CgogICAgICAgICAgICAgICAgICAgIGV4cGlyeVRpbWVySWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVMZWZ0LS07CiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVTcGFuLmlubmVyVGV4dCA9IE1hdGgubWF4KHRpbWVMZWZ0LCAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRpbWVMZWZ0IDw9IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoZXhwaXJ5VGltZXJJZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcnlUaW1lcklkID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhZGdlLmNsYXNzTGlzdC5yZW1vdmUoJ2JnLXdhcm5pbmcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhZGdlLmNsYXNzTGlzdC5hZGQoJ2JnLWRhbmdlcicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZVNwYW4uaW5uZXJUZXh0ID0gIkVYUElSRUQiOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lckJhZGdlJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZXJCYWRnZScpLmNsYXNzTGlzdC5yZW1vdmUoJ2JnLWRhbmdlcicpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lckJhZGdlJykuY2xhc3NMaXN0LmFkZCgnYmctd2FybmluZycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyYXdFbWFpbERpc3BsYXknKS5pbm5lckhUTUwgPQogICAgICAgICAgICAgICAgICAgICc8c3BhbiBzdHlsZT0iY29sb3I6I2YzOGJhODsiPkVycm9yIGdlbmVyYXRpbmcgZW1haWw6ICcgKyBlcnIubWVzc2FnZSArICc8L3NwYW4+JzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYXN5bmMgZnVuY3Rpb24gcmVwbGF5QXR0YWNrKCkgewogICAgICAgICAgICBpZiAoIWN1cnJlbnRSYXdFbWFpbCkgewogICAgICAgICAgICAgICAgYWxlcnQoIk5vIGVtYWlsIGludGVyY2VwdGVkIHlldCEgQ2xpY2sgJ0ludGVyY2VwdCAmIFNpZ24gRW1haWwnIGZpcnN0IChTdGVwIDEpLiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyAxLiBUcmlnZ2VyIEFuaW1hdGlvbgogICAgICAgICAgICBjb25zdCBwYWNrZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFja2V0Jyk7CiAgICAgICAgICAgIHBhY2tldC5jbGFzc0xpc3QucmVtb3ZlKCdhbmltYXRlLWF0dGFjaycpOwogICAgICAgICAgICB2b2lkIHBhY2tldC5vZmZzZXRXaWR0aDsgLy8gVHJpZ2dlciByZWZsb3cKICAgICAgICAgICAgcGFja2V0LmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGUtYXR0YWNrJyk7CgogICAgICAgICAgICAvLyAyLiBGZXRjaCBWZXJpZmljYXRpb24gKHdhaXQgZm9yIGFuaW1hdGlvbiB0byBzeW5jKQogICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL3ZlcmlmeScsIHsKICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LAogICAgICAgICAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IHJhd19lbWFpbDogY3VycmVudFJhd0VtYWlsIH0pCiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHRocm93IG5ldyBFcnJvcihgU2VydmVyIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c31gKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOwoKICAgICAgICAgICAgICAgICAgICAvLyAzLiBTaG93IFJlc3VsdHMKICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0dXNCYWRnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2ZXJpZnlTdGF0dXMnKTsKICAgICAgICAgICAgICAgICAgICBzdGF0dXNCYWRnZS5pbm5lclRleHQgPSBkYXRhLnN0YXR1czsKICAgICAgICAgICAgICAgICAgICBzdGF0dXNCYWRnZS5jbGFzc05hbWUgPSBgYmFkZ2UgYmctJHtkYXRhLmNzc19jbGFzc30gc3RhdHVzLWJhZGdlYDsKCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZlcmlmeURldGFpbHMnKS5pbm5lclRleHQgPSBkYXRhLmRldGFpbHM7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdEFyZWEnKS5zdHlsZS5vcGFjaXR5ID0gJzEnOwoKICAgICAgICAgICAgICAgICAgICAvLyA0LiBTaG93IGVkdWNhdGlvbmFsIGV4cGxhbmF0aW9uCiAgICAgICAgICAgICAgICAgICAgc2hvd0V4cGxhbmF0aW9uKGRhdGEpOwoKICAgICAgICAgICAgICAgICAgICAvLyA1LiBTaW11bGF0ZSBkZWxpdmVyeSB0byBpbmJveGVzCiAgICAgICAgICAgICAgICAgICAgc2ltdWxhdGVEZWxpdmVyeShkYXRhLCBjdXJyZW50UmF3RW1haWwpOwoKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2ZXJpZnlTdGF0dXMnKS5pbm5lclRleHQgPSAnRVJST1InOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2ZXJpZnlTdGF0dXMnKS5jbGFzc05hbWUgPSAnYmFkZ2UgYmctd2FybmluZyBzdGF0dXMtYmFkZ2UnOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2ZXJpZnlEZXRhaWxzJykuaW5uZXJUZXh0ID0gJ1JlcXVlc3QgZmFpbGVkOiAnICsgZXJyLm1lc3NhZ2U7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdEFyZWEnKS5zdHlsZS5vcGFjaXR5ID0gJzEnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCAxNTAwKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHNob3dFeHBsYW5hdGlvbihkYXRhKSB7CiAgICAgICAgICAgIGNvbnN0IGFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwbGFuYXRpb25BcmVhJyk7CiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwbGFuYXRpb25UZXh0Jyk7CgogICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09ICdQQVNTJykgewogICAgICAgICAgICAgICAgdGV4dC5pbm5lckhUTUwgPSAnVGhlIERLSU0gc2lnbmF0dXJlIHdhcyA8c3Ryb25nPmNyeXB0b2dyYXBoaWNhbGx5IHZhbGlkPC9zdHJvbmc+IGFuZCBubyBleHBpcnkgY2hlY2sgd2FzIGVuZm9yY2VkLiAnCiAgICAgICAgICAgICAgICAgICAgKyAnVGhlIHJlcGxheWVkIGVtYWlsIHdhcyBhY2NlcHRlZCBhcyBnZW51aW5lLiBJbiBhIHJlYWwgYXR0YWNrLCB0aGUgdmljdGltIHdvdWxkIHNlZSB0aGlzIGluIHRoZWlyIGluYm94ICcKICAgICAgICAgICAgICAgICAgICArICdhbmQgbGlrZWx5IHRydXN0IGl0ICZtZGFzaDsgYmVjYXVzZSB0aGUgc2lnbmF0dXJlIElTIHJlYWwuICcKICAgICAgICAgICAgICAgICAgICArICc8YnI+PGJyPjxzdHJvbmc+VGFrZWF3YXk6PC9zdHJvbmc+IFN0YW5kYXJkIERLSU0gYWxvbmUgZG9lcyBub3QgcHJldmVudCByZXBsYXkgYXR0YWNrcy4nOwogICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuc3RhdHVzID09PSAnQkxPQ0tFRCcpIHsKICAgICAgICAgICAgICAgIHRleHQuaW5uZXJIVE1MID0gJ1RoZSBES0lNIHNpZ25hdHVyZSB3YXMgPHN0cm9uZz5jcnlwdG9ncmFwaGljYWxseSB2YWxpZDwvc3Ryb25nPiwgYnV0IHRoZSBzZXJ2ZXIgZW5mb3JjZWQgYSAnCiAgICAgICAgICAgICAgICAgICAgKyAnPHN0cm9uZz50aW1lc3RhbXAgZXhwaXJ5IGNoZWNrPC9zdHJvbmc+LiBUaGUgc2lnbmF0dXJlIHdhcyB0b28gb2xkLCBzbyB0aGUgZW1haWwgd2FzIHJlamVjdGVkLiAnCiAgICAgICAgICAgICAgICAgICAgKyAnPGJyPjxicj48c3Ryb25nPlRha2Vhd2F5Ojwvc3Ryb25nPiBUaW1lc3RhbXAtYmFzZWQgZXhwaXJ5IChjaGVja2luZyA8Y29kZT50PTwvY29kZT4gYW5kIDxjb2RlPng9PC9jb2RlPiB0YWdzKSAnCiAgICAgICAgICAgICAgICAgICAgKyAnaXMgYW4gZWZmZWN0aXZlIGRlZmVuc2UgYWdhaW5zdCByZXBsYXkgYXR0YWNrcy4nOwogICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuc3RhdHVzID09PSAnRkFJTCcpIHsKICAgICAgICAgICAgICAgIHRleHQuaW5uZXJIVE1MID0gJ1RoZSBES0lNIHNpZ25hdHVyZSA8c3Ryb25nPmZhaWxlZCBjcnlwdG9ncmFwaGljIHZlcmlmaWNhdGlvbjwvc3Ryb25nPi4gJwogICAgICAgICAgICAgICAgICAgICsgJ1RoaXMgbWVhbnMgdGhlIGVtYWlsIHdhcyB0YW1wZXJlZCB3aXRoIGFmdGVyIHNpZ25pbmcsIG9yIHRoZSBrZXlzIGRvblwndCBtYXRjaC4gJwogICAgICAgICAgICAgICAgICAgICsgJzxicj48YnI+PHN0cm9uZz5UYWtlYXdheTo8L3N0cm9uZz4gREtJTSBjb3JyZWN0bHkgZGV0ZWN0cyB0YW1wZXJpbmcgJm1kYXNoOyB0aGlzIGlzIGl0cyBwcmltYXJ5IHB1cnBvc2UuJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRleHQuaW5uZXJIVE1MID0gJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQgZHVyaW5nIHZlcmlmaWNhdGlvbi4gQ2hlY2sgdGhlIHNlcnZlciBjb25zb2xlIGZvciBkZXRhaWxzLic7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFyZWEuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgfQoKICAgICAgICBhc3luYyBmdW5jdGlvbiBzY2FuRG9tYWluKCkgewogICAgICAgICAgICBjb25zdCBkb21haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFyZ2V0RG9tYWluJykudmFsdWUudHJpbSgpOwogICAgICAgICAgICBpZiAoIWRvbWFpbikgeyBhbGVydCgnRW50ZXIgYSBkb21haW4gZmlyc3QuJyk7IHJldHVybjsgfQoKICAgICAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYW5CdG4nKTsKICAgICAgICAgICAgYnRuLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgYnRuLmlubmVySFRNTCA9ICc8c3BhbiBjbGFzcz0ic2Nhbi1zcGlubmVyIj48L3NwYW4+IFNjYW5uaW5nLi4uJzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Z1bG5SZXN1bHRzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYW5uZXJFZHVjYXRpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9jaGVja192dWxuZXJhYmlsaXR5JywgewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LAogICAgICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgZG9tYWluOiBkb21haW4gfSkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHRocm93IG5ldyBFcnJvcihgU2VydmVyIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c31gKTsKICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CgogICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSAnRVJST1InKSB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoZGF0YS5kZXRhaWxzKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gUmlzayBHYXVnZQogICAgICAgICAgICAgICAgY29uc3QgZ2F1Z2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlza0dhdWdlJyk7CiAgICAgICAgICAgICAgICBjb25zdCBnYXVnZUNvbG9yID0gZGF0YS52ZXJkaWN0X2NsYXNzID09PSAnZGFuZ2VyJyA/ICcjZjM4YmE4JwogICAgICAgICAgICAgICAgICAgIDogZGF0YS52ZXJkaWN0X2NsYXNzID09PSAnd2FybmluZycgPyAnI2ZhYjM4NycgOiAnI2E2ZTNhMSc7CiAgICAgICAgICAgICAgICBnYXVnZS5zdHlsZS5iYWNrZ3JvdW5kID0gYGNvbmljLWdyYWRpZW50KCR7Z2F1Z2VDb2xvcn0gJHtkYXRhLnJpc2tfc2NvcmV9JSwgIzMxMzI0NCAwJSlgOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jpc2tTY29yZScpLmlubmVyVGV4dCA9IGRhdGEucmlza19zY29yZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaXNrU2NvcmUnKS5zdHlsZS5jb2xvciA9IGdhdWdlQ29sb3I7CgogICAgICAgICAgICAgICAgLy8gVmVyZGljdCBCYWRnZQogICAgICAgICAgICAgICAgY29uc3QgYmFkZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmVyZGljdEJhZGdlJyk7CiAgICAgICAgICAgICAgICBiYWRnZS5pbm5lclRleHQgPSBkYXRhLnZlcmRpY3Q7CiAgICAgICAgICAgICAgICBiYWRnZS5jbGFzc05hbWUgPSBgYmFkZ2UgYmctJHtkYXRhLnZlcmRpY3RfY2xhc3N9IGZzLTYgcHgtMyBweS0yYDsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2ZXJkaWN0U3VtbWFyeScpLmlubmVyVGV4dCA9IGRhdGEuc3VtbWFyeTsKCiAgICAgICAgICAgICAgICAvLyBGaW5kaW5ncwogICAgICAgICAgICAgICAgY29uc3QgbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaW5kaW5nc0xpc3QnKTsKICAgICAgICAgICAgICAgIGxpc3QuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgICAgICBkYXRhLmZpbmRpbmdzLmZvckVhY2goZiA9PiB7CiAgICAgICAgICAgICAgICAgICAgbGlzdC5pbm5lckhUTUwgKz0gYAogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ2dWxuLWNhcmQgc2V2ZXJpdHktJHtmLnNldmVyaXR5fSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIG1iLTEiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgJHtmLmljb259IG1lLTIiIHN0eWxlPSJjb2xvcjoke2Yuc2V2ZXJpdHkgPT09ICdoaWdoJyA/ICcjZjM4YmE4JyA6IGYuc2V2ZXJpdHkgPT09ICdtZWRpdW0nID8gJyNmYWIzODcnIDogJyNhNmUzYTEnfSI+PC9pPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJvbmc+JHtlc2NhcGVIdG1sKGYudGl0bGUpfTwvc3Ryb25nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJiYWRnZSBiZy0ke2Yuc2V2ZXJpdHkgPT09ICdoaWdoJyA/ICdkYW5nZXInIDogZi5zZXZlcml0eSA9PT0gJ21lZGl1bScgPyAnd2FybmluZycgOiAnc3VjY2Vzcyd9IG1zLWF1dG8iPiR7Zi5zZXZlcml0eS50b1VwcGVyQ2FzZSgpfTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsIGNsYXNzPSJ0ZXh0LW11dGVkIj4ke2VzY2FwZUh0bWwoZi5kZXRhaWwpfTwvc21hbGw+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndnVsblJlc3VsdHMnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FubmVyRWR1Y2F0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICBhbGVydCgnU2NhbiBmYWlsZWQ6ICcgKyBlcnIubWVzc2FnZSk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBidG4uZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGJ0bi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1jcm9zc2hhaXJzIj48L2k+IFNjYW4gRG9tYWluJzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVXRpbGl0eTogZXNjYXBlIEhUTUwgdG8gcHJldmVudCBYU1MgZnJvbSBETlMgcmVjb3JkIGNvbnRlbnQKICAgICAgICBmdW5jdGlvbiBlc2NhcGVIdG1sKHN0cikgewogICAgICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgZGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHN0cikpOwogICAgICAgICAgICByZXR1cm4gZGl2LmlubmVySFRNTDsKICAgICAgICB9CgogICAgICAgIC8vIEluYm94IFNpbXVsYXRpb24gaGVscGVycwogICAgICAgIGZ1bmN0aW9uIHNhbml0aXplUHJldmlldyhyYXcpIHsKICAgICAgICAgICAgcmV0dXJuIGVzY2FwZUh0bWwocmF3KS5zcGxpdCgnXG4nKS5zbGljZSgwLCA2KS5qb2luKCc8YnI+Jyk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzaW11bGF0ZURlbGl2ZXJ5KHZlcmlmeURhdGEsIHJhd0VtYWlsKSB7CiAgICAgICAgICAgIGNvbnN0IHZpY3RpbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWN0aW1JbmJveCcpOwogICAgICAgICAgICBjb25zdCBxdWFyYW50aW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3F1YXJhbnRpbmVJbmJveCcpOwoKICAgICAgICAgICAgaWYgKCF2aWN0aW0gfHwgIXF1YXJhbnRpbmUpIHJldHVybjsKCiAgICAgICAgICAgIC8vIENsZWFyIGRlZmF1bHQgcGxhY2Vob2xkZXJzCiAgICAgICAgICAgIGlmICh2aWN0aW0uaW5uZXJIVE1MLmluY2x1ZGVzKCdObyBtZXNzYWdlcycpKSB2aWN0aW0uaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgIGlmIChxdWFyYW50aW5lLmlubmVySFRNTC5pbmNsdWRlcygnTm8gbWVzc2FnZXMnKSkgcXVhcmFudGluZS5pbm5lckhUTUwgPSAnJzsKCiAgICAgICAgICAgIGNvbnN0IHByZXZpZXcgPSBzYW5pdGl6ZVByZXZpZXcocmF3RW1haWwgfHwgJycpOwogICAgICAgICAgICBjb25zdCB0aW1lID0gbmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKTsKCiAgICAgICAgICAgIGlmICh2ZXJpZnlEYXRhLnN0YXR1cyA9PT0gJ1BBU1MnKSB7CiAgICAgICAgICAgICAgICB2aWN0aW0uaW5uZXJIVE1MID0gYDxkaXYgY2xhc3M9Im1iLTIiPgogICAgICAgICAgICAgICAgICAgIDxzdHJvbmcgc3R5bGU9ImNvbG9yOiNhNmUzYTE7Ij4ke3RpbWV9ICZtZGFzaDsgRGVsaXZlcmVkPC9zdHJvbmc+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic21hbGwiIHN0eWxlPSJjb2xvcjojYmFjMmRlOyI+JHtlc2NhcGVIdG1sKHZlcmlmeURhdGEuZGV0YWlscyl9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iY29sb3I6I2RiZWFmZTtwYWRkaW5nOjZweDttYXJnaW4tdG9wOjZweDtib3JkZXItcmFkaXVzOjRweDtmb250LXNpemU6MC44cmVtOyI+JHtwcmV2aWV3fTwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+YCArIHZpY3RpbS5pbm5lckhUTUw7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodmVyaWZ5RGF0YS5zdGF0dXMgPT09ICdCTE9DS0VEJyB8fCB2ZXJpZnlEYXRhLnN0YXR1cyA9PT0gJ0ZBSUwnKSB7CiAgICAgICAgICAgICAgICBxdWFyYW50aW5lLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPSJtYi0yIj4KICAgICAgICAgICAgICAgICAgICA8c3Ryb25nIHN0eWxlPSJjb2xvcjojZjM4YmE4OyI+JHt0aW1lfSAmbWRhc2g7ICR7dmVyaWZ5RGF0YS5zdGF0dXMgPT09ICdCTE9DS0VEJyA/ICdCbG9ja2VkIChSZXBsYXkpJyA6ICdSZWplY3RlZCAoSW52YWxpZCknfTwvc3Ryb25nPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNtYWxsIiBzdHlsZT0iY29sb3I6I2JhYzJkZTsiPiR7ZXNjYXBlSHRtbCh2ZXJpZnlEYXRhLmRldGFpbHMpfTwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImNvbG9yOiNmNmQxZDk7cGFkZGluZzo2cHg7bWFyZ2luLXRvcDo2cHg7Ym9yZGVyLXJhZGl1czo0cHg7Zm9udC1zaXplOjAuOHJlbTsiPiR7cHJldmlld308L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PmAgKyBxdWFyYW50aW5lLmlubmVySFRNTDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHF1YXJhbnRpbmUuaW5uZXJIVE1MID0gYDxkaXYgY2xhc3M9Im1iLTIiPgogICAgICAgICAgICAgICAgICAgIDxzdHJvbmcgc3R5bGU9ImNvbG9yOiNmYWIzODc7Ij4ke3RpbWV9ICZtZGFzaDsgRXJyb3I8L3N0cm9uZz4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzbWFsbCIgc3R5bGU9ImNvbG9yOiNiYWMyZGU7Ij4ke2VzY2FwZUh0bWwodmVyaWZ5RGF0YS5kZXRhaWxzKX08L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PmAgKyBxdWFyYW50aW5lLmlubmVySFRNTDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIDwvc2NyaXB0PgoKPC9ib2R5PgoKPC9odG1sPgo=';
const PRIV_PEM_B64='LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2UUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktjd2dnU2pBZ0VBQW9JQkFRQ3RDOG1aeDZINFpHdEIKNVBjQ3p0ZzlneHF3enlnNGc1VWsrZnM4cGRMWXRyRG1MRmFjazVJVUZLN1hsdjRxZXBVY3I1allOdno2d2NlRApLc3l2WGNzOGxqWDN4NURoRkk2OGdDUFFiM1BxMFAwTVdma3NJdFZ6TDBRNW84TXZDbG1UU25PbDZDdzg2VU1TCnNBc3k3c2pyRHJiRW1DMnZHTVFwUmlnNmN2Nkl3QXpRTUNkcmw1d3N5NVpUMHM2ZEI0T1JDSlpJUlgyeWZLWWMKSXhPYkEvdFl4VitEYUNZRit0MkhKZHV4NU9QN3pqT2VoZVpKTVRnVUllYkFMbXFTdEp2WGgxbXZVMlY5SUZ0eQp2N1UxVVJKNTRTK0Q2RmMwLzB2MzJ6UUZjTnlPMFU1OUlMSGlhZlBicGhXTkliUmFaa1IwbndxYnBxeEhWU1RGClVqR05JQlNKQWdNQkFBRUNnZ0VBSnlHWFFUTW5xV2ZyNlViQnBOenBnVjk0VmF0Q3lTVFlRVGhXVyt5VHRYWDYKb3RJNzg4UmJNRGROSW10K3BsUjZDN2FadGFzWm9nclg5dzFpby9WdDFCR1R1cWhpVnNPelUyVVd0RGUvMnNYUApzMDlWVFduREl2ejVUSjkvcjgrRFdnOW4vNGgxR0lFWExjNnBlYWNOd0RuZmtxMW5CMFZ1ZG5icStleXZLblVEClRaZzVMQUdOb1dyd2o5V2tjSU54Y1FlaExwZmc4RUtjLzVISXpTaVRLVUxNdkh2ZXFiR0xTdFY3anhxNFpGVUcKOWFkRHhXb1daelR2Tk9uSUtmNExIREg4SklxdTdha2ZXemNGWlBrRWI1YjBWSXF4YTBtaHhQb3dtQUw0dXRSQwoxaDI3NnpGZy9lWmpqdEU1dTBzeG9HTW1jaDdTOUhWWXdwWlZkWDF3a1FLQmdRRHlUcE1BR3RlVS9PQWk1RHJyCm5HaXlUSE1kNGhFNW1NdWdxemdDTm54TGxPWUp6YUpKNm9ndDUwUWlzSXoweHZwUEE1bFdIZUZWbG92MlNlK2oKdFR5dFJGdVlHbjNqK1JwYmZJSWJjWm54cHNqYnhKU2NxTU9LWE4rdjRGODJBblMvQ3YwMEJ2bUh0dU5WV2p1bQozRHpEdFVmcm1TaEUwSUZqQjVScHJiNmdHd0tCZ1FDMjB6bG1pTDFmeVNvV0xYL24zdmtGMTNhTDJJb1hVdWthCjloWS9GVktMMzJoaTYzTXF0aFN5M1pJbTdUSitRRVhwejJZQ1RjSTkwQmo0N2NPUGRFUTZyZ2ZBWFBTdFlyZm4KYlZJY2tDRFNDM3pjNlVqOEo1UEVIZXQxZFYya3BzN2ltSjE2elF0NFl0SEoyZlZ6bTRNSkF2akJvNndnZytHTwpEd04vWk9TUUt3S0JnUURnV1hBeVFLZ3JBcGhrdGZ6MytqSFdKSUxSd0dkQ2RQN1ZITE1YR1d1c2I0a3V1bjd4CkFYNWxRaVFNR252b2gvTnJCV0lNSWs1bytLTk92dFpyTlh1ZzBoSWNteXJFMGZoZGpNTEt0anhiU3BuZklmeVgKc0lxY3FiRlRIdVFKRmUwU2xoSXJBZW80aGxXbXlZMUJ5ZGxaTzVnRHhDTk0wK0Y0MTZQSzFWd1MwUUtCZ0JFcwpUaHYvaENwWEx3amVSVUYyaEZXMEk0S0hXSkZRVEcwbjZIY01mYkI5ejhSYThYcDFtQVFsSS9GY0huNFZjM3UrCjY0b1QyOGNLb1EzZzU1bTJCaUtzN2pWM2hkUXpqYXJEYmc4WXlyeHdMODVnYTJha0lSRXU3a3NlTnltY01acS8KVXl1Unp4NER5a2ozbkVLN3ZOYy8zRFgwTmRyb0NHdmJwU3gyUWJINUFvR0FTVTdicURCMEdxZTZGWDIxL2FUbAp1K2pXbGI5Y25JM0sxVTZNTFRCdWQ5bzBNdlVDSlQ4eWJqaGlodUJJTE82L09lcTBrSmlYRW80RlpnN3llMlR2CnhsOGYrbHJ6NTBWM3VpcGRmdEhCbUxXc2ZremcvTWhEUjN5d0YxeG5GaGd1T01CeUNKSjJ5WTdCUTVFTURYYVgKYTExWTRSWW5WbFVXYnE0RmJWbHM2Smc9Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K';
const PUB_PEM_B64='LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFyUXZKbWNlaCtHUnJRZVQzQXM3WQpQWU1hc004b09JT1ZKUG43UEtYUzJMYXc1aXhXbkpPU0ZCU3UxNWIrS25xVkhLK1kyRGI4K3NISGd5ck1yMTNMClBKWTE5OGVRNFJTT3ZJQWowRzl6NnREOURGbjVMQ0xWY3k5RU9hUERMd3BaazBwenBlZ3NQT2xERXJBTE11N0kKNnc2MnhKZ3RyeGpFS1VZb09uTCtpTUFNMERBbmE1ZWNMTXVXVTlMT25RZURrUWlXU0VWOXNueW1IQ01UbXdQNwpXTVZmZzJnbUJmcmRoeVhic2VUais4NHpub1htU1RFNEZDSG13QzVxa3JTYjE0ZFpyMU5sZlNCYmNyKzFOVkVTCmVlRXZnK2hYTlA5TDk5czBCWERjanRGT2ZTQ3g0bW56MjZZVmpTRzBXbVpFZEo4S202YXNSMVVreFZJeGpTQVUKaVFJREFRQUIKLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCg==';
function b64ToStr(b64){ if (typeof atob === 'function') return atob(b64); return Buffer.from(b64,'base64').toString('utf8'); }
function arrayBufferToBase64(buf){ const bytes = new Uint8Array(buf); let binary=''; for (let i=0;i<bytes.byteLength;i++) binary += String.fromCharCode(bytes[i]); if (typeof btoa === 'function') return btoa(binary); return Buffer.from(binary,'binary').toString('base64'); }
function pemToBinary(pemStr){ const lines = pemStr.split(/\r?\n/); const b64 = lines.filter(l=>l.indexOf('-----')===-1).join(''); if (typeof atob === 'function'){ const raw = atob(b64); const arr = new Uint8Array(raw.length); for (let i=0;i<raw.length;i++) arr[i]=raw.charCodeAt(i); return arr.buffer; } else { return Uint8Array.from(Buffer.from(b64,'base64')).buffer; } }

async function importPrivateKey(){ const pem = b64ToStr(PRIV_PEM_B64); const binary = pemToBinary(pem); return crypto.subtle.importKey('pkcs8', binary, { name: 'RSASSA-PKCS1-v1_5', hash: 'SHA-256' }, false, ['sign']); }
async function importPublicKey(){ const pem = b64ToStr(PUB_PEM_B64); const binary = pemToBinary(pem); return crypto.subtle.importKey('spki', binary, { name: 'RSASSA-PKCS1-v1_5', hash: 'SHA-256' }, false, ['verify']); }

function normalizeBody(body){ if (!body) return ''; body = body.replace(/\r?\n/g,'\r\n'); while (body.endsWith('\r\n')) body = body.slice(0,-2); return body; }
function headersToMap(headersText){ const lines = headersText.split(/\r?\n/); const map = {}; for (const line of lines){ const idx = line.indexOf(':'); if (idx>0){ const name=line.slice(0,idx).trim(); const val=line.slice(idx+1).trim(); map[name.toLowerCase()] = val; }} return map; }

export default {
  async fetch(request){
    const url = new URL(request.url);
    const path = url.pathname;

    if (path === '/sign' && request.method === 'POST'){
      const bodyJson = await request.json().catch(()=>({}));
      const from = bodyJson.from || 'alice@example.com';
      const to = bodyJson.to || 'bob@example.com';
      const subj = bodyJson.subject || 'Test DKIM';
      const body = bodyJson.body || 'Hello, this is a signed message.';

      const now = Math.floor(Date.now()/1000);
      const canonicalBody = normalizeBody(body);
      const bhBuf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(canonicalBody));
      const bh = arrayBufferToBase64(bhBuf);

      const headersList = ['from','to','subject','date'];
      const date = new Date(now*1000).toUTCString();
      const d = 'example.com';
      const s = 'demo';
      const h = headersList.join(':');

      let dkimHeader = `v=1; a=rsa-sha256; d=${d}; s=${s}; t=${now}; h=${h}; bh=${bh}; b=`;

      let signingString = '';
      signingString += `from:${from}\r\n`;
      signingString += `to:${to}\r\n`;
      signingString += `subject:${subj}\r\n`;
      signingString += `date:${date}\r\n`;
      signingString += `dkim-signature:${dkimHeader}`;

      const privKey = await importPrivateKey();
      const sigBuf = await crypto.subtle.sign({ name: 'RSASSA-PKCS1-v1_5' }, privKey, new TextEncoder().encode(signingString));
      const sigB64 = arrayBufferToBase64(sigBuf);

      dkimHeader = `v=1; a=rsa-sha256; d=${d}; s=${s}; t=${now}; h=${h}; bh=${bh}; b=${sigB64}`;

      const rawEmail = `From: ${from}\r\nTo: ${to}\r\nSubject: ${subj}\r\nDate: ${date}\r\nDKIM-Signature: ${dkimHeader}\r\n\r\n${body}`;
      return new Response(JSON.stringify({ raw_email: rawEmail }), { headers: { 'content-type': 'application/json' } });
    }

    if (path === '/verify' && request.method === 'POST'){
      const bodyJson = await request.json().catch(()=>({}));
      const raw = bodyJson.raw_email || '';
      const parts = raw.split(/\r?\n\r?\n/);
      const headerText = parts[0] || '';
      const bodyText = parts.slice(1).join('\r\n\r\n') || '';
      const map = headersToMap(headerText);
      const dkimMatch = headerText.match(/DKIM-Signature:\s*([\s\S]*)/i);
      if (!dkimMatch){ return new Response(JSON.stringify({ status:'FAIL', css_class:'warning', details:'No DKIM-Signature header' }), { headers:{ 'content-type':'application/json' } }); }
      const dkimRaw = dkimMatch[1] || '';
      const fields = {};
      dkimRaw.split(/;\s*/).forEach(tok=>{ const kv = tok.split('='); if(kv[0]) fields[kv[0].trim()]=kv.slice(1).join('='); });
      const bh = (fields['bh']||'').replace(/\s+/g,'');
      const b = (fields['b']||'').replace(/\s+/g,'');
      const hlist = (fields['h']||'').split(':').map(x=>x.trim().toLowerCase());
      const t = parseInt(fields['t']||'0',10);

      const canonicalBody = normalizeBody(bodyText);
      const bhBuf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(canonicalBody));
      const bhCalc = arrayBufferToBase64(bhBuf);
      if (bhCalc !== bh){ return new Response(JSON.stringify({ status:'FAIL', css_class:'warning', details:'Body hash mismatch' }), { headers:{ 'content-type':'application/json' } }); }

      let signingString = '';
      for (const hd of hlist){ const val = map[hd] || ''; signingString += `${hd}:${val}\r\n`; }
      const dkimHeaderNoB = dkimRaw.replace(/b=([^;\r\n]*)/,'b=');
      signingString += `dkim-signature:${dkimHeaderNoB}`;

      const pubKey = await importPublicKey();
      // decode b to ArrayBuffer
      const sigBin = (typeof atob==='function') ? Uint8Array.from(atob(b), c=>c.charCodeAt(0)).buffer : Buffer.from(b,'base64');
      const ok = await crypto.subtle.verify({ name: 'RSASSA-PKCS1-v1_5' }, pubKey, sigBin, new TextEncoder().encode(signingString));

      let status='PASS', css_class='success', details='Signature valid';
      if (!ok) { status='FAIL'; css_class='warning'; details='Signature verification failed'; }
      else if (t && ((Date.now()/1000)-t)>5) { status='BLOCKED'; css_class='danger'; details='Signature expired (replay)'; }
      return new Response(JSON.stringify({ status, css_class, details }), { headers:{ 'content-type':'application/json' } });
    }

    if (path === '/check_vulnerability' && request.method === 'POST'){
      return new Response(JSON.stringify({ status:'OK', verdict:'Not Vulnerable', verdict_class:'ok', risk_score:10, summary:'No obvious issues', findings:[] }), { headers:{ 'content-type':'application/json' } });
    }

    const html = (typeof atob==='function')? atob(HTML_B64) : Buffer.from(HTML_B64,'base64').toString('utf8');
    return new Response(html, { headers:{ 'content-type':'text/html; charset=utf-8' } });
  }
};
